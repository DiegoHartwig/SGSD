<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>SGSD - Service Desk</title>
	<h:outputStylesheet library="css" name="estilo.css" />

</h:head>
<h:body>
	<!-- begin header -->
	<div
		style="width: 100%; line-height: 15px; background: #296ad4; color: #fff;">
		<p:graphicImage name="/img/SGSD.png" style="width:120px; padding:5px;" />
	</div>	
	<!-- end header -->

	<!-- begin menu -->
	<h:form>
		<p:menubar>
			<p:menuitem value="Chamados" url="/restrito/chamados.xhtml"
				icon="ui-icon-lightbulb" />
			<p:menuitem value="Usuários" url="/restrito/usuarios.xhtml"
				icon="	ui-icon-person" />
			<p:menuitem value="Técnicos" url="/restrito/tecnicos.xhtml"
				icon="ui-icon-wrench" />
			<p:menuitem value="Setores" url="/restrito/setores.xhtml"
				icon="ui-icon-home" />
			<p:menuitem value="Equipes" url="/restrito/equipes.xhtml"
				icon="ui-icon-contact" />
			<p:menuitem value="Configurações" url="/restrito/config.xhtml"
				icon="ui-icon-gear " />
			<p:menuitem value="Avaliações" url="/restrito/avaliacoes.xhtml"
				icon="ui-icon-clipboard" />
			<p:menuitem value="Sair" action="#{tecBean.logout}"
				icon="ui-icon-power" />			
			<f:facet name="options">
				<h:outputText value="Olá, " />
				<h:outputText value="#{tecBean.usuarioLog}" />											
			</f:facet>	
		</p:menubar>
	</h:form>
	<!--end menu -->

	<!-- Loading -->
	<p:ajaxStatus onstart="PF('statusDialog').show()"
		onsuccess="PF('statusDialog').hide()" />
	<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
		closable="false" resizable="false" showHeader="false">
		<p:graphicImage name="/img/loader.gif" />
	</p:dialog>

	<!-- begin form -->
	<h:form id="frmChamados">

		<p:panel id="painelUsuario">

			<p:growl id="growl" sticky="true" life="3000" />

			<p:dataTable id="listagem_chamados" value="#{chamadoBean.chamados}"
				var="c" filteredValue="#{chamadoBean.chamadosFiltrados}"
				draggableColumns="true" style="margin-bottom:0" scrollable="true"
				scrollWidth="98%" paginator="true" rows="8"
				paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="5,8,15,20" paginatorPosition="bottom"
				selection="#{chamadoBean.chamadoSelecionado}" selectionMode="single"
				rowKey="#{c.id}" paginatorAlwaysVisible="true"
				currentPageReportTemplate="{totalRecords} Chamados"
				emptyMessage="Nenhum chamado cadastrado.">

				<p:ajax event="rowSelect" />

				<f:facet name="header">
      				  Chamados
    			</f:facet>

				<p:column headerText="" style="width:26px;" exportable="false">
					<p:commandButton icon="ui-icon-pencil"
						actionListener="#{chamadoBean.selecionarChamado}"
						action="#{janelaBean.abrirAtualizarChamado}" style="width:25px;"
						title="Atualizar Informações do Chamado" />
				</p:column>

				<p:column style="width:110px;" filterBy="#{c.id}">
					<f:facet name="header">
						<h:outputText value="ID Chamado" />
					</f:facet>
					<h:outputText value="#{c.id}" />
				</p:column>

				<p:column style="width:110px;" filterBy="#{c.status}">
					<f:facet name="header">
						<h:outputText value="Status" />
					</f:facet>
					<h:outputText value="#{c.status}"
						rendered="#{c.status eq 'Em Aberto'}"
						style="color: #00578A; font-weight:bold; font-size:9pt;" />
					<h:outputText value="#{c.status}"
						rendered="#{c.status eq 'Em Andamento'}"
						style="color: #298F00; font-size:9pt; " />
					<h:outputText value="#{c.status}"
						rendered="#{c.status eq 'Concluido'}"
						style="color: #0588BC; font-size:9pt;" />
				</p:column>

				<p:column style="width:110px;" filterBy="#{c.usuario.nome}">
					<f:facet name="header">
						<h:outputText value="Solicitante" />
					</f:facet>
					<h:outputText value="#{c.usuario.nome}" />
				</p:column>

				<p:column style="width:110px;" filterBy="#{c.tecnico.nome}">
					<f:facet name="header">
						<h:outputText value="Técnico" />
					</f:facet>
					<h:outputText value="#{c.tecnico.nome}" />
				</p:column>

				<p:column style="width:250px;" filterBy="#{c.titulo}">
					<f:facet name="header">
						<h:outputText value="Assunto" />
					</f:facet>
					<h:outputText value="#{c.titulo}" />
				</p:column>

				<p:column style="width:120px;">
					<f:facet name="header">
						<h:outputText value="Criado em:" />
					</f:facet>
					<h:outputText value="#{c.data_abertura}" converter="dateConverter" />
				</p:column>

				<p:column style="width:120px;">
					<f:facet name="header">
						<h:outputText value="Conclusão:" />
					</f:facet>
					<h:outputText value="#{c.data_encerramento}"
						converter="dateConverter" />
				</p:column>

				<p:column style="width:250px;" exportable="false">
					<f:facet name="header">
						<h:outputText value="Descrição" />
					</f:facet>
					<h:outputText value="#{c.descricao}" />
				</p:column>


				<p:column style="width:110px;" exportable="false">
					<f:facet name="header">
						<h:outputText value="Tipo" />
					</f:facet>
					<h:outputText value="#{c.tipo}" />
				</p:column>


			</p:dataTable>

			<p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
				<p:commandButton value="SIM" type="button"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
				<p:commandButton value="NÃO" type="button"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			</p:confirmDialog>

			<p:toolbar>
				<p:toolbarGroup>
					<p:commandButton value="Novo Chamado"
						actionListener="#{chamadoBean.novoChamado}"
						action="#{janelaBean.abrirNovoChamado}" icon="ui-icon-circle-plus"
						immediate="true">
					</p:commandButton>

				</p:toolbarGroup>

				<p:toolbarGroup align="right">
					<h:commandLink title="Exportar Chamados para Excel">
						<p:graphicImage library="img" name="excel.png" width="24" />
						<p:dataExporter type="xls" target="listagem_chamados"
							fileName="chamados" encoding="UTF-8" />
					</h:commandLink>
					<h:commandLink title="Exportar Chamados para PDF">
						<p:graphicImage library="img" name="pdf.png" width="24" />
						<p:dataExporter type="pdf" target="listagem_chamados"
							fileName="chamados" preProcessor="#{chamadoBean.preProcessPDF}" encoding="iso-8859-1" />
					</h:commandLink>
				</p:toolbarGroup>
			</p:toolbar>
		</p:panel>
	</h:form>
</h:body>

</html>